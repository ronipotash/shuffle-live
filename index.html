<script>
document.addEventListener('DOMContentLoaded', () => {
  const shuffleBtn = document.getElementById('shuffleBtn');
  const splash = document.getElementById('splash');
  const songInfo = document.getElementById('songInfo');
  const songTitle = document.getElementById('songTitle');
  const songArtist = document.getElementById('songArtist');
  const songAlbum = document.getElementById('songAlbum');
  const songCover = document.getElementById('songCover');
  const songLinks = document.getElementById('songLinks');
  const playBtn = document.getElementById('playBtn');
  const stopBtn = document.getElementById('stopBtn');
  const audioPlayer = document.getElementById('audioPlayer');

  const randomTerms = ["love", "dance", "night", "sun", "dream", "ra", "yo", "star"];

  splash.style.transition = 'opacity 1s ease';
  setTimeout(() => {
    splash.style.opacity = 0.01;
    setTimeout(() => {
      splash.classList.add('hidden');
      shuffleBtn.classList.remove('hidden');
    }, 1000);
  }, 3000);

  shuffleBtn.addEventListener('click', () => {
    const term = randomTerms[Math.floor(Math.random() * randomTerms.length)];
    fetch(`https://corsproxy.io/?https://api.deezer.com/search?q=${term}`)
      .then(res => res.json())
      .then(data => {
        if (!data.data || data.data.length === 0) return alert("No songs found");
        const track = data.data[Math.floor(Math.random() * data.data.length)];
        songTitle.textContent = track.title;
        songArtist.textContent = `ðŸ‘¤ ${track.artist.name}`;
        songAlbum.textContent = `ðŸ’¿ ${track.album.title}`;
        songCover.style.backgroundImage = `url('${track.album.cover_medium}')`;
        songLinks.innerHTML = `ðŸ”— <a href="${track.link}" target="_blank">Listen on Deezer</a>`;
        audioPlayer.src = track.preview;
        songInfo.classList.remove('hidden');
        songInfo.classList.add('fade-in');
      })
      .catch(err => {
        console.error(err);
        alert("Failed to fetch song from Deezer");
      });
  });

  playBtn.addEventListener('click', () => audioPlayer.play());
  stopBtn.addEventListener('click', () => {
    audioPlayer.pause();
    audioPlayer.currentTime = 0;
  });
});
</script>
